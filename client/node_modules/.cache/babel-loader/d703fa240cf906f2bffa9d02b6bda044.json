{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/blog/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Projects/blog/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Projects/blog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from'react';import axios from'axios';import{Context}from'../../context/Context';import'./write.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append('name',filename);data.append('file',file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post('/upload',data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post('/posts',newPost);case 18:res=_context.sent;window.location.replace('/post/'+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:'none'},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"names":["React","useContext","useState","axios","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"sources":["D:/Projects/blog/client/src/pages/write/Write.jsx"],"sourcesContent":["import React, { useContext, useState } from 'react'\r\nimport axios from 'axios'\r\nimport { Context } from '../../context/Context'\r\nimport './write.css'\r\n\r\nexport default function Write() {\r\n  const [title, setTitle] = useState('')\r\n  const [desc, setDesc] = useState('')\r\n  const [file, setFile] = useState(null)\r\n  const { user } = useContext(Context)\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n    const newPost = {\r\n      username: user.username,\r\n      title,\r\n      desc,\r\n    }\r\n    if (file) {\r\n      const data = new FormData()\r\n      const filename = Date.now() + file.name\r\n      data.append('name', filename)\r\n      data.append('file', file)\r\n      newPost.photo = filename\r\n      try {\r\n        await axios.post('/upload', data)\r\n      } catch (err) {}\r\n    }\r\n    try {\r\n      const res = await axios.post('/posts', newPost)\r\n      window.location.replace('/post/' + res.data._id)\r\n    } catch (err) {}\r\n  }\r\n\r\n  return (\r\n    <div className='write'>\r\n      {file && (\r\n        <img className='writeImg' src={URL.createObjectURL(file)} alt='' />\r\n      )}\r\n      <form className='writeForm' onSubmit={handleSubmit}>\r\n        <div className='writeFormGroup'>\r\n          <label htmlFor='fileInput'>\r\n            <i className='writeIcon fas fa-plus'></i>\r\n          </label>\r\n          <input\r\n            type='file'\r\n            id='fileInput'\r\n            style={{ display: 'none' }}\r\n            onChange={(e) => setFile(e.target.files[0])}\r\n          />\r\n          <input\r\n            type='text'\r\n            placeholder='Title'\r\n            className='writeInput'\r\n            autoFocus={true}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className='writeFormGroup'>\r\n          <textarea\r\n            placeholder='Tell your story...'\r\n            type='text'\r\n            className='writeInput writeText'\r\n            onChange={(e) => setDesc(e.target.value)}\r\n          ></textarea>\r\n        </div>\r\n        <button className='writeSubmit' type='submit'>\r\n          Publish\r\n        </button>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"uVAAA,MAAOA,MAAP,EAAgBC,UAAhB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,uBAAxB,CACA,MAAO,aAAP,C,wFAEA,cAAe,SAASC,MAAT,EAAiB,CAC9B,cAA0BH,QAAQ,CAAC,EAAD,CAAlC,wCAAOI,KAAP,eAAcC,QAAd,eACA,eAAwBL,QAAQ,CAAC,EAAD,CAAhC,yCAAOM,IAAP,eAAaC,OAAb,eACA,eAAwBP,QAAQ,CAAC,IAAD,CAAhC,yCAAOQ,IAAP,eAAaC,OAAb,eACA,gBAAiBV,UAAU,CAACG,OAAD,CAA3B,CAAQQ,IAAR,aAAQA,IAAR,CAEA,GAAMC,aAAY,4FAAG,iBAAOC,CAAP,kJACnBA,CAAC,CAACC,cAAF,GACMC,OAFa,CAEH,CACdC,QAAQ,CAAEL,IAAI,CAACK,QADD,CAEdX,KAAK,CAALA,KAFc,CAGdE,IAAI,CAAJA,IAHc,CAFG,KAOfE,IAPe,0BAQXQ,IARW,CAQJ,GAAIC,SAAJ,EARI,CASXC,QATW,CASAC,IAAI,CAACC,GAAL,GAAaZ,IAAI,CAACa,IATlB,CAUjBL,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBJ,QAApB,EACAF,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBd,IAApB,EACAM,OAAO,CAACS,KAAR,CAAgBL,QAAhB,CAZiB,uCAcTjB,MAAK,CAACuB,IAAN,CAAW,SAAX,CAAsBR,IAAtB,CAdS,0IAkBCf,MAAK,CAACuB,IAAN,CAAW,QAAX,CAAqBV,OAArB,CAlBD,SAkBXW,GAlBW,eAmBjBC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,SAAWH,GAAG,CAACT,IAAJ,CAASa,GAA5C,EAnBiB,+JAAH,kBAAZlB,aAAY,4CAAlB,CAuBA,mBACE,aAAK,SAAS,CAAC,OAAf,WACGH,IAAI,eACH,YAAK,SAAS,CAAC,UAAf,CAA0B,GAAG,CAAEsB,GAAG,CAACC,eAAJ,CAAoBvB,IAApB,CAA/B,CAA0D,GAAG,CAAC,EAA9D,EAFJ,cAIE,cAAM,SAAS,CAAC,WAAhB,CAA4B,QAAQ,CAAEG,YAAtC,wBACE,aAAK,SAAS,CAAC,gBAAf,wBACE,cAAO,OAAO,CAAC,WAAf,uBACE,UAAG,SAAS,CAAC,uBAAb,EADF,EADF,cAIE,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,WAFL,CAGE,KAAK,CAAE,CAAEqB,OAAO,CAAE,MAAX,CAHT,CAIE,QAAQ,CAAE,kBAACpB,CAAD,QAAOH,QAAO,CAACG,CAAC,CAACqB,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAd,EAJZ,EAJF,cAUE,cACE,IAAI,CAAC,MADP,CAEE,WAAW,CAAC,OAFd,CAGE,SAAS,CAAC,YAHZ,CAIE,SAAS,CAAE,IAJb,CAKE,QAAQ,CAAE,kBAACtB,CAAD,QAAOP,SAAQ,CAACO,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAf,EALZ,EAVF,GADF,cAmBE,YAAK,SAAS,CAAC,gBAAf,uBACE,iBACE,WAAW,CAAC,oBADd,CAEE,IAAI,CAAC,MAFP,CAGE,SAAS,CAAC,sBAHZ,CAIE,QAAQ,CAAE,kBAACvB,CAAD,QAAOL,QAAO,CAACK,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAd,EAJZ,EADF,EAnBF,cA2BE,eAAQ,SAAS,CAAC,aAAlB,CAAgC,IAAI,CAAC,QAArC,qBA3BF,GAJF,GADF,CAsCD"},"metadata":{},"sourceType":"module"}